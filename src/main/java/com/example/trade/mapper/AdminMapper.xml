<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.trade.mapper.AdminMapper">
	<!-- 로그인 이력 조회 -->
	<select id="selectLoginHistory" resultType="map">
		SELECT
			login_history_no AS loginHistoryNo,
			id,
			login_time AS loginTime
		FROM login_history
	</select>
	
	<!-- 알림 목록 조회 -->
	<select id="selectAlarmList" resultType="map">
		SELECT
			n.notification_no AS notificationNo,
			CASE n.target_type
				WHEN 'USER' THEN CONCAT('ID : ', n.target_value)
				WHEN 'ROLE' THEN ct.code_name
				WHEN 'ALL'  THEN '전체회원'
			END AS targetDisplay,
			
			CASE n.notification_type
				WHEN 'NC001' THEN '주문'
				WHEN 'NC002' THEN '배송'
				WHEN 'NC003' THEN '결제'
				WHEN 'NC004' THEN '이벤트'
				WHEN 'NC005' THEN '시스템'
				WHEN 'NC006' THEN '기타'
			END AS notificationType,
			
			n.notification_title AS notificationTitle,
			n.notification_content AS notificationContent,
			n.target_url AS targetUrl,
			n.image_url AS imageUrl,
			n.read_status AS readStatus,
			n.read_date AS readDate,
			n.create_user AS createUser,
			n.create_date AS createDate,
			n.update_user AS updateUser,
			n.update_date AS updateDate,
			n.use_status AS useStatus
		FROM notification n LEFT JOIN comm_tbl ct
		ON n.target_value = ct.code_number
	</select>
</mapper>